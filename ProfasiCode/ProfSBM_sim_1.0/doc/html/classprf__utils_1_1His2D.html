<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf_utils::His2D Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf__utils.html">prf_utils</a>::<a class="el" href="classprf__utils_1_1His2D.html">His2D</a>
  </div>
</div>
<div class="contents">
<h1>prf_utils::His2D Class Reference<br/>
<small>
[<a class="el" href="group__utilities.html">Utilities</a>]</small>
</h1><!-- doxytag: class="prf_utils::His2D" -->
<p>A histogram with 2 independent variables.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;His2D.hh&gt;</code></p>

<p><a href="classprf__utils_1_1His2D-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abef67f36c3334daac388d8ea7ca8b460"></a><!-- doxytag: member="prf_utils::His2D::operator=" ref="abef67f36c3334daac388d8ea7ca8b460" args="(const His2D &amp;)" -->
<a class="el" href="classprf__utils_1_1His2D.html">His2D</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#abef67f36c3334daac388d8ea7ca8b460">operator=</a> (const <a class="el" href="classprf__utils_1_1His2D.html">His2D</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">One can assign a histogram to another. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac88b24044c6e7e883adf61bd586abf0b"></a><!-- doxytag: member="prf_utils::His2D::init" ref="ac88b24044c6e7e883adf61bd586abf0b" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ac88b24044c6e7e883adf61bd586abf0b">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Necessary to call this after specifying number of bins etc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa20f3a85eca73209e248c338c229e118"></a><!-- doxytag: member="prf_utils::His2D::reset" ref="aa20f3a85eca73209e248c338c229e118" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#aa20f3a85eca73209e248c338c229e118">reset</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Does not deallocate memory, but clears the collected statistics. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada93fa1b40d279fbf8f32620ef954175"></a><!-- doxytag: member="prf_utils::His2D::Range" ref="ada93fa1b40d279fbf8f32620ef954175" args="(double x0, double x1, double x2, double x3)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ada93fa1b40d279fbf8f32620ef954175">Range</a> (double x0, double x1, double x2, double x3)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set range in x and y directions. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa9482f305e5894a67322e5a10945c204"></a><!-- doxytag: member="prf_utils::His2D::XRange" ref="aa9482f305e5894a67322e5a10945c204" args="(double x0, double x1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#aa9482f305e5894a67322e5a10945c204">XRange</a> (double x0, double x1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set only the x range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acec4a5d8b1635ed6888472f39f689958"></a><!-- doxytag: member="prf_utils::His2D::YRange" ref="acec4a5d8b1635ed6888472f39f689958" args="(double x0, double x1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#acec4a5d8b1635ed6888472f39f689958">YRange</a> (double x0, double x1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set only the y range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adfb707d52dfa475b7097f15fd934a82f"></a><!-- doxytag: member="prf_utils::His2D::NXbins" ref="adfb707d52dfa475b7097f15fd934a82f" args="(int v)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#adfb707d52dfa475b7097f15fd934a82f">NXbins</a> (int v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of bins in the X-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36d74dcc7127b2b68d4c2bdb4e72899a"></a><!-- doxytag: member="prf_utils::His2D::NYbins" ref="a36d74dcc7127b2b68d4c2bdb4e72899a" args="(int v)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a36d74dcc7127b2b68d4c2bdb4e72899a">NYbins</a> (int v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of bins in the Y-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3d0cb97b571d4fd9853fb34150bbd26"></a><!-- doxytag: member="prf_utils::His2D::NXbins" ref="ad3d0cb97b571d4fd9853fb34150bbd26" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ad3d0cb97b571d4fd9853fb34150bbd26">NXbins</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current number of bins in the X-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e0e41a1108e14cabc0b70ad9c6034eb"></a><!-- doxytag: member="prf_utils::His2D::NYbins" ref="a0e0e41a1108e14cabc0b70ad9c6034eb" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a0e0e41a1108e14cabc0b70ad9c6034eb">NYbins</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current number of bins in the Y-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae02ab32a8f1c17ffb767afd7f3cf9a66"></a><!-- doxytag: member="prf_utils::His2D::Xmin" ref="ae02ab32a8f1c17ffb767afd7f3cf9a66" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ae02ab32a8f1c17ffb767afd7f3cf9a66">Xmin</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the lower limit of the current X-range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8cd0ebf49b392a945a99db92cfb3b161"></a><!-- doxytag: member="prf_utils::His2D::Xmax" ref="a8cd0ebf49b392a945a99db92cfb3b161" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a8cd0ebf49b392a945a99db92cfb3b161">Xmax</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the upper limit of the current X-range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a46f98fb986134621dcb02ff71c20dc6b"></a><!-- doxytag: member="prf_utils::His2D::Ymin" ref="a46f98fb986134621dcb02ff71c20dc6b" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a46f98fb986134621dcb02ff71c20dc6b">Ymin</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the lower limit of the current Y-range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec30037ffeef7de55e663f1188b1a298"></a><!-- doxytag: member="prf_utils::His2D::Ymax" ref="aec30037ffeef7de55e663f1188b1a298" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#aec30037ffeef7de55e663f1188b1a298">Ymax</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the upper limit of the current Y-range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae1e02a0859b5350086565d4906fa9674"></a><!-- doxytag: member="prf_utils::His2D::xval" ref="ae1e02a0859b5350086565d4906fa9674" args="(int i)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ae1e02a0859b5350086565d4906fa9674">xval</a> (int i)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">X value for the i'th bin on the X-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeccd9d9f304cf305e8d3b743fa049adf"></a><!-- doxytag: member="prf_utils::His2D::yval" ref="aeccd9d9f304cf305e8d3b743fa049adf" args="(int i)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#aeccd9d9f304cf305e8d3b743fa049adf">yval</a> (int i)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Y value for the i'th bin on the Y-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c1850bae28a4d5694451710007bde1f"></a><!-- doxytag: member="prf_utils::His2D::val" ref="a1c1850bae28a4d5694451710007bde1f" args="(int i, int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a1c1850bae28a4d5694451710007bde1f">val</a> (int i, int j)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Z value for the i'th bin along X and j'th bin along Y-axis. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#afcaed3575fe5533b0d03d94715970d07">put</a> (double x, double y)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put a new datapoint (x,y) into the histogram.  <a href="#afcaed3575fe5533b0d03d94715970d07"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a7d00a2763845df6bb9b0f3c5bfe13841">normalize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert the collected frequency data to probabilities.  <a href="#a7d00a2763845df6bb9b0f3c5bfe13841"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4164a55d1be6aed1568b22dc31470e32"></a><!-- doxytag: member="prf_utils::His2D::Export" ref="a4164a55d1be6aed1568b22dc31470e32" args="(const char *filename, int fmt=3)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a4164a55d1be6aed1568b22dc31470e32">Export</a> (const char *filename, int fmt=3)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Save histogram information in a file for plotting. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ada92b6ac741c337f637b65df6d90d678">Import</a> (const char *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read back histogram information from exported text files.  <a href="#ada92b6ac741c337f637b65df6d90d678"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a294f107497115bf68e18a82b3ba63931"></a><!-- doxytag: member="prf_utils::His2D::save_state" ref="a294f107497115bf68e18a82b3ba63931" args="(const char *filename)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#a294f107497115bf68e18a82b3ba63931">save_state</a> (const char *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Save current state of sampling in a binary file to resume counting later. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adb24a38396f606d3c5efec8755eb868a"></a><!-- doxytag: member="prf_utils::His2D::read_state" ref="adb24a38396f606d3c5efec8755eb868a" args="(const char *filename)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#adb24a38396f606d3c5efec8755eb868a">read_state</a> (const char *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve stored sampling state to resume counting. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afdc37442788f60f553df42232f4f949e"></a><!-- doxytag: member="prf_utils::His2D::operator+=" ref="afdc37442788f60f553df42232f4f949e" args="(const His2D &amp;)" -->
<a class="el" href="classprf__utils_1_1His2D.html">His2D</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#afdc37442788f60f553df42232f4f949e">operator+=</a> (const <a class="el" href="classprf__utils_1_1His2D.html">His2D</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add the contents of another histogram. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac6e814369bb85a6990aff2562f61fcc3"></a><!-- doxytag: member="prf_utils::His2D::Projection_X" ref="ac6e814369bb85a6990aff2562f61fcc3" args="(std::vector&lt; double &gt; &amp;hsx)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ac6e814369bb85a6990aff2562f61fcc3">Projection_X</a> (std::vector&lt; double &gt; &amp;hsx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For each x, return Sum z(x,y) | y=0..ymax. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad17684a97caf4879f266da7db92e4ac6"></a><!-- doxytag: member="prf_utils::His2D::Projection_Y" ref="ad17684a97caf4879f266da7db92e4ac6" args="(std::vector&lt; double &gt; &amp;hsy)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His2D.html#ad17684a97caf4879f266da7db92e4ac6">Projection_Y</a> (std::vector&lt; double &gt; &amp;hsy)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For each y, return Sum z(x,y) | x=0..xmax. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classprf__utils_1_1His2D.html" title="A histogram with 2 independent variables.">His2D</a> represents histograms of the type dP/dxdy to chart out the probability distribution of a variable z as a function of two variables x and y.</p>
<p>Data can be stored in two supported layouts in text files. To describe we use the notation zij=P(xi,yj).</p>
<p>The layout means, when the histogram data is written to a file, it is formatted like this:<br/>
 <br/>
 x0 y0 z00 <br/>
 x0 y1 z01 <br/>
 x0 y2 z02 <br/>
 ... <br/>
 x0 yn z0n <br/>
 <br/>
 x1 y0 z10 <br/>
 x1 y1 z11 <br/>
 ... <br/>
</p>
<p>In the second supported data layout, the data is saved in 3 files. One representing just the x values, { x0, x1,... }, one with only the y values {y1,y2 ...}, and one with the z values :<br/>
<br/>
 z00 z01 z02 ... z0n<br/>
 z10 z11 z12 ... z1n<br/>
 z20 ...<br/>
 ...<br/>
 where n is (n_ybins -1) This format takes less space on disk. It became the default layout in PROFASI v 1.4. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ada92b6ac741c337f637b65df6d90d678"></a><!-- doxytag: member="prf_utils::His2D::Import" ref="ada92b6ac741c337f637b65df6d90d678" args="(const char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int His2D::Import </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>filename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Import is only implemented for files exported with the default format, fmt=3. In this format, there are a few comment lines beginning with "#" giving ranges and number of bins. Then there is a matrix M of data of (nxbins+1) rows and (nybins+1) columns. The top-left element, with index (0,0) is always 0. The elements M[0,1+j], for j in the range (0,nybins) are the centres of the ybins for the data. Similarly, M[1+i,0] for i in range (0,nxbins) are the centres of xbins. The elements M[1+i,1+j] with i in range (0,nxbins) and j in range (0,nybins) then represent the probabilities P(X[i],Y[j]). </p>

</div>
</div>
<a class="anchor" id="a7d00a2763845df6bb9b0f3c5bfe13841"></a><!-- doxytag: member="prf_utils::His2D::normalize" ref="a7d00a2763845df6bb9b0f3c5bfe13841" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double His2D::normalize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>After a call to normalize, the sum of all elements in the histogram is 1, provided all attempted put(x,y) operations succeeded, i.e., there were no out of range values. </p>

</div>
</div>
<a class="anchor" id="afcaed3575fe5533b0d03d94715970d07"></a><!-- doxytag: member="prf_utils::His2D::put" ref="afcaed3575fe5533b0d03d94715970d07" args="(double x, double y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int His2D::put </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>y</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>We are concerned with keeping track of how often an certain combination (x,y) occurs. This function should be called for every sampling event. Then after a large number of sampling events, the histogram will contain the probabilities (frequencies, if not normalized) for the different (x,y) pairs. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Aux/His2D.hh</li>
<li>model/Aux/His2D.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
