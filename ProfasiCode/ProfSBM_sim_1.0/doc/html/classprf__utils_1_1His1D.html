<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf_utils::His1D Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf__utils.html">prf_utils</a>::<a class="el" href="classprf__utils_1_1His1D.html">His1D</a>
  </div>
</div>
<div class="contents">
<h1>prf_utils::His1D Class Reference<br/>
<small>
[<a class="el" href="group__utilities.html">Utilities</a>]</small>
</h1><!-- doxytag: class="prf_utils::His1D" -->
<p>The default histogram utility in ProFASi is based on <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a>.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;His1D.hh&gt;</code></p>

<p>Inherited by <a class="el" href="classprf__utils_1_1AdaptiveHis.html">prf_utils::AdaptiveHis</a>.</p>

<p><a href="classprf__utils_1_1His1D-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adaaa7d8f284879d4fc11aa06c33776ee"></a><!-- doxytag: member="prf_utils::His1D::His1D" ref="adaaa7d8f284879d4fc11aa06c33776ee" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#adaaa7d8f284879d4fc11aa06c33776ee">His1D</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0c88f21c3b601ac559fc2f383a4907e4"></a><!-- doxytag: member="prf_utils::His1D::His1D" ref="a0c88f21c3b601ac559fc2f383a4907e4" args="(int nbl)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a0c88f21c3b601ac559fc2f383a4907e4">His1D</a> (int nbl)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a> with nbl blocks (create nbl histograms). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af49ec46726ba8afc205e2841e5da23d9"></a><!-- doxytag: member="prf_utils::His1D::His1D" ref="af49ec46726ba8afc205e2841e5da23d9" args="(double xmn, double xmx, int npnts, int numblocks=1)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#af49ec46726ba8afc205e2841e5da23d9">His1D</a> (double xmn, double xmx, int npnts, int numblocks=1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct with xmin, xmax, number of bins and number of blocks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a940237fa167535038e4c0e388cc835f6">His1D</a> (double xmn, double xmx, double bnsz, int numblocks=1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct with xmin, xmax, bin size and number of blocks.  <a href="#a940237fa167535038e4c0e388cc835f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afefa2b18bb29eebff65eba4b189d6ba9"></a><!-- doxytag: member="prf_utils::His1D::His1D" ref="afefa2b18bb29eebff65eba4b189d6ba9" args="(const His1D &amp;)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#afefa2b18bb29eebff65eba4b189d6ba9">His1D</a> (const <a class="el" href="classprf__utils_1_1His1D.html">His1D</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor (copies data, so do not initialize after this!). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b09c6d9d3be29ebeef6ffd24318abaf"></a><!-- doxytag: member="prf_utils::His1D::operator=" ref="a5b09c6d9d3be29ebeef6ffd24318abaf" args="(const His1D &amp;)" -->
<a class="el" href="classprf__utils_1_1His1D.html">His1D</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a5b09c6d9d3be29ebeef6ffd24318abaf">operator=</a> (const <a class="el" href="classprf__utils_1_1His1D.html">His1D</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assignment operator (copies data, do not initialize after this!). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a758aa4cc2a94c10c4e1759e8c942153d"></a><!-- doxytag: member="prf_utils::His1D::Name" ref="a758aa4cc2a94c10c4e1759e8c942153d" args="(std::string nm)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a758aa4cc2a94c10c4e1759e8c942153d">Name</a> (std::string nm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Give it a name. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae032e4fab910b940e802bfa7e051f9e2"></a><!-- doxytag: member="prf_utils::His1D::init" ref="ae032e4fab910b940e802bfa7e051f9e2" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#ae032e4fab910b940e802bfa7e051f9e2">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes using info about range etc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7650d032a627ba76ad0bd2ff34c9da4a"></a><!-- doxytag: member="prf_utils::His1D::reset" ref="a7650d032a627ba76ad0bd2ff34c9da4a" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a7650d032a627ba76ad0bd2ff34c9da4a">reset</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset all data (init calls this). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae7665fa640192f6f2866b7be21e40cd8"></a><!-- doxytag: member="prf_utils::His1D::NBlocks" ref="ae7665fa640192f6f2866b7be21e40cd8" args="(int n)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#ae7665fa640192f6f2866b7be21e40cd8">NBlocks</a> (int n)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make it a histogram of n blocks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa372f0e3473f81ab1736f4e49ddc0360"></a><!-- doxytag: member="prf_utils::His1D::NBlocks" ref="aa372f0e3473f81ab1736f4e49ddc0360" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#aa372f0e3473f81ab1736f4e49ddc0360">NBlocks</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the number of blocks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2a8fe0fcfa05d0b0f12459a10b4baebc"></a><!-- doxytag: member="prf_utils::His1D::n_entries" ref="a2a8fe0fcfa05d0b0f12459a10b4baebc" args="(int i) const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a2a8fe0fcfa05d0b0f12459a10b4baebc">n_entries</a> (int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">number of entries in block i <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea4f28f0b6c86afd7bf96ca8160b6fd3"></a><!-- doxytag: member="prf_utils::His1D::n_entries_in_range" ref="aea4f28f0b6c86afd7bf96ca8160b6fd3" args="(int i) const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#aea4f28f0b6c86afd7bf96ca8160b6fd3">n_entries_in_range</a> (int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">number of entries in block i in range <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9835f066aa1df73e0ffd1d15c4d5a155"></a><!-- doxytag: member="prf_utils::His1D::Range" ref="a9835f066aa1df73e0ffd1d15c4d5a155" args="(double x0, double x1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a9835f066aa1df73e0ffd1d15c4d5a155">Range</a> (double x0, double x1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set range. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a2488cfc207b2b8083db64eb49d09bd"></a><!-- doxytag: member="prf_utils::His1D::Nbins" ref="a9a2488cfc207b2b8083db64eb49d09bd" args="(int v)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a9a2488cfc207b2b8083db64eb49d09bd">Nbins</a> (int v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set number of bins. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0fd3c61e055e688258e032942552af1e"></a><!-- doxytag: member="prf_utils::His1D::Nbins" ref="a0fd3c61e055e688258e032942552af1e" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a0fd3c61e055e688258e032942552af1e">Nbins</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get number of bins. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a76f97eae62025d80f95c48bc11ae189c">set_bin_size</a> (double sz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set bin size.  <a href="#a76f97eae62025d80f95c48bc11ae189c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac17df78c997f62d648c2513690e9e391"></a><!-- doxytag: member="prf_utils::His1D::Xmin" ref="ac17df78c997f62d648c2513690e9e391" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#ac17df78c997f62d648c2513690e9e391">Xmin</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get xmin. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a15913a56bba0b996734a2b3d8a755996"></a><!-- doxytag: member="prf_utils::His1D::Xmax" ref="a15913a56bba0b996734a2b3d8a755996" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a15913a56bba0b996734a2b3d8a755996">Xmax</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get xmax. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af7e368a70db1a14b5c122b9ed043e4e3"></a><!-- doxytag: member="prf_utils::His1D::Xbin" ref="af7e368a70db1a14b5c122b9ed043e4e3" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#af7e368a70db1a14b5c122b9ed043e4e3">Xbin</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get bin size. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7a534ee589a07227d607019c225606d4"></a><!-- doxytag: member="prf_utils::His1D::xval" ref="a7a534ee589a07227d607019c225606d4" args="(int i)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a7a534ee589a07227d607019c225606d4">xval</a> (int i)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">x value for the middle of i'th bin <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af62bd9501ace59f12fc47cb6e6c00577"></a><!-- doxytag: member="prf_utils::His1D::yval" ref="af62bd9501ace59f12fc47cb6e6c00577" args="(int iblk, int i)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#af62bd9501ace59f12fc47cb6e6c00577">yval</a> (int iblk, int i)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">y value for the middle of i'th bin <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7909d5fa10d3af08670aebe0c8fa5cf1"></a><!-- doxytag: member="prf_utils::His1D::put" ref="a7909d5fa10d3af08670aebe0c8fa5cf1" args="(double x, int iblk=0)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a7909d5fa10d3af08670aebe0c8fa5cf1">put</a> (double x, int iblk=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">put value x into the iblk block <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a172da82799c3d9307cdfd1738e0fca8f"></a><!-- doxytag: member="prf_utils::His1D::nput" ref="a172da82799c3d9307cdfd1738e0fca8f" args="(double howmanytimes, double x, int iblk)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a172da82799c3d9307cdfd1738e0fca8f">nput</a> (double howmanytimes, double x, int iblk)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">put n indentical values at once <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14b947d128b7628a86caed4c7f4ea6a4"></a><!-- doxytag: member="prf_utils::His1D::normalize" ref="a14b947d128b7628a86caed4c7f4ea6a4" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a14b947d128b7628a86caed4c7f4ea6a4">normalize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">normalize histogram so that each block sums to 1 <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa94c3298f695d85c5eca4443e45a8e5d"></a><!-- doxytag: member="prf_utils::His1D::unnormalize" ref="aa94c3298f695d85c5eca4443e45a8e5d" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#aa94c3298f695d85c5eca4443e45a8e5d">unnormalize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">unnormalize histogram so that each block sums to its occupancy <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a90ec7fae4c27a10ff4324e27bcaf9678">Export</a> (const char *filename, int normmode=2, int datlayout=2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Export data in text format to a given file.  <a href="#a90ec7fae4c27a10ff4324e27bcaf9678"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4c50c88719166f139b7af001c297ec1c"></a><!-- doxytag: member="prf_utils::His1D::Import" ref="a4c50c88719166f139b7af001c297ec1c" args="(const char *filename)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a4c50c88719166f139b7af001c297ec1c">Import</a> (const char *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import histogram data written in the format of Export function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93f1b445681e18179378982b78c66541"></a><!-- doxytag: member="prf_utils::His1D::operator+=" ref="a93f1b445681e18179378982b78c66541" args="(His1D &amp;)" -->
virtual <a class="el" href="classprf__utils_1_1His1D.html">His1D</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf__utils_1_1His1D.html#a93f1b445681e18179378982b78c66541">operator+=</a> (<a class="el" href="classprf__utils_1_1His1D.html">His1D</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add information from another given histogram. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class can be used to construct histograms of one variable in ProFASi. In practice, the derived class <a class="el" href="classprf__utils_1_1AdaptiveHis.html" title="A histogram that can adjust its own range according to the data.">AdaptiveHis</a>, which can adjust its own range is used. But most of the functionality of the histograms is implemented in <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a>, and is described here. Typical use: </p>
<div class="fragment"><pre class="fragment">
       His1D his;
       his.Range(0,25);
       his.NBins(100);
       his.init();
       while (you are doing something useful) {
          do_some_great_calculations();
          x=a_very_important_number();
          his.put(x);
       }
       his.Export("his_avim.dat");
     </pre></div><p> When you "put" lots of numbers into a <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a> object as above, it measures how often the values you put were in different bins. The bins are calculated between the range you provide and the number of bins you set. Upon "Export()", you get a file with what the histogram has measured. Just how the measured histograms are reported in the output file varies, and needs a bit more explanation.</p>
<h3>Normalization </h3>
<p>A histogram may or may not be normalized. If it is not normalized, the y values for each x bin is simply the frequency of data points in the range (x-0.5*dx, x+0.5*dx). There is a function <a class="el" href="classprf__utils_1_1His1D.html#a14b947d128b7628a86caed4c7f4ea6a4" title="normalize histogram so that each block sums to 1">normalize()</a> that can ask the histogram to normalize its data, so that the sum of the y values for all x bins is 1. The normalization can be undone with the <a class="el" href="classprf__utils_1_1His1D.html#aa94c3298f695d85c5eca4443e45a8e5d" title="unnormalize histogram so that each block sums to its occupancy">unnormalize()</a> function. But an explicit call to <a class="el" href="classprf__utils_1_1His1D.html#a14b947d128b7628a86caed4c7f4ea6a4" title="normalize histogram so that each block sums to 1">normalize()</a> is normally not necessary. When the histogram is saved, the data written to the file is normalized, without changing the internal frequency counts. This way, a histogram can save normalized data at intermediate stages during a run, without messing up the frequencies. So, you don't normally need to call <a class="el" href="classprf__utils_1_1His1D.html#a14b947d128b7628a86caed4c7f4ea6a4" title="normalize histogram so that each block sums to 1">normalize()</a>.</p>
<p>Sometimes, the absolute observed frequencies rather than normalized data is of interest. So, it should be possible to save them. Therefore, the function "Export()" can be given a normalization mode parameter.</p>
<p><code>his.Export</code>("his_avim.dat",0);</p>
<p>The raw frequencies are then saved with no normalization. Two additional modes of normalization are supported. Normalization mode 1 means that the sum of the values at all bins is 1. In normalization mode 2, sum of the values at each bin multiplied by the bin sizes is 1. In mode 1, two histograms of the same data, with different bin sizes, will superficially look different when plotted. The one with bigger bins will end up with larger amplitudes. In mode 2, the height of the histogram plots will be unchanged when bin size is changed.</p>
<h3>Histogram data blocks</h3>
<p>Another important aspect of <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a> objects is that they are intrinsically indexed. Meaning, if you need 8 histograms for the same quantity corresponding to 8 values of some state designator, you only need one <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a>. But you give it 8 blocks with the <a class="el" href="classprf__utils_1_1His1D.html#ae7665fa640192f6f2866b7be21e40cd8" title="Make it a histogram of n blocks.">NBlocks(int)</a> function. As an example, we take a parallel tempering run with 64 temperatures. Histograms of energy at every temperature is interesting. But then we end up with 64 histograms for total energy, and 64 again for every other quantity we wish to measure. In situations like this, you create a <a class="el" href="classprf__utils_1_1His1D.html" title="The default histogram utility in ProFASi is based on His1D.">His1D</a> object with many blocks, 64 in this case. Data for different blocks are written into the same output file, and of course, each block is separately normalized. In principle, this is just a way to combine related histograms into one file for the output, and one object for less cumbersome handling in the program.</p>
<h3>Data layout in ProFASi histogram files</h3>
<p>There are two supported layouts for the histogram data. One can choose the desired layout by passing an additional parameter to "Export()".</p>
<p><code>his.Export</code>("his_avim.dat", 2,2);</p>
<p>The layout referred to as "profasi_his_v1" is the layout familiar to ProFASi users from older versions of the program. The data blocks are organized as: </p>
<div class="fragment"><pre class="fragment">
       b0 x0 y00
       b0 x1 y01
       b0 x2 y02
       b0 x3 ...
       ...
       blank line
       b1 x0 y10
       b1 x1 y11
       etc.
     </pre></div><p> In the above, b0, b1 etc were integer block identifiers. The different blocks could represent, for instance, different temperatures. Plotting this kind of a histogram file in GNUPLOT is easy:</p>
<p><code>gnuplot&gt;</code> p "myhis.dat" u 2:3 w l</p>
<p>This gives one line for each block. But this format is not very economic. The X values are repeated in every block. The numbers b0, b1 etc are written many times. The second supported format addresses these issues. The layout referred to as "profasi_his_v2" is like this: </p>
<div class="fragment"><pre class="fragment">
       x0 y00 y10 y20 y30 ...
       x1 y01 y11 y21 y31 ...
       x2 y02 y12 y22 y31 ...
       etc.
     </pre></div><p> The first column has the X values. The subsequent columns have the Y data for blocks 0, 1, 2 ... The block numbers are never written. The X values are written once. To plot it in GNUPLOT write:</p>
<p><code>gnuplot&gt;</code> p "myhis.dat" u 1:someblock w l</p>
<p>This will plot only one line at a time, depending on what block you choose.</p>
<p>If the histogram has only a single block, the block id is always 0 and is not written even in the layout profasi_his_v1. In this situation, the two layouts are equivalent. Histograms generated with ProFASi versions up to 1.2 were always in layout profasi_his_v1. In version 1.5, the default layout is changed to profasi_his_v2. The program his1dmerge (See <a class="el" href="his1dmerge.html">Merging and converting ProFASi histograms with his1dmerge</a>) can be used to change histogram data layout as well as normalization modes.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>his1dmerge </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a940237fa167535038e4c0e388cc835f6"></a><!-- doxytag: member="prf_utils::His1D::His1D" ref="a940237fa167535038e4c0e388cc835f6" args="(double xmn, double xmx, double bnsz, int numblocks=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">His1D::His1D </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>xmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>bnsz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numblocks</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The given range (xmn, xmx) is symmetrically extended to accommodate an integral number of bins of the requested size, if needed. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a90ec7fae4c27a10ff4324e27bcaf9678"></a><!-- doxytag: member="prf_utils::His1D::Export" ref="a90ec7fae4c27a10ff4324e27bcaf9678" args="(const char *filename, int normmode=2, int datlayout=2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void His1D::Export </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>normmode</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datlayout</em> = <code>2</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Choose between different normalization modes and data layout options as described above. </p>

<p>Reimplemented in <a class="el" href="classprf__utils_1_1AdaptiveHis.html#aaac1edc9b1f9c1c86b03afb8d9521d21">prf_utils::AdaptiveHis</a>.</p>

</div>
</div>
<a class="anchor" id="a76f97eae62025d80f95c48bc11ae189c"></a><!-- doxytag: member="prf_utils::His1D::set_bin_size" ref="a76f97eae62025d80f95c48bc11ae189c" args="(double sz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void His1D::set_bin_size </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sz</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create bins of a given size. The existing histogram range is extended to accommmodate an integral number of bins. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Aux/His1D.hh</li>
<li>model/Aux/His1D.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
