<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: extract_snapshot Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>extract_snapshot Class Reference</h1><!-- doxytag: class="extract_snapshot" -->
<p>Extracting a snapshot configuration.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;extract_snapshot.hh&gt;</code></p>

<p><a href="classextract__snapshot-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The program <a class="el" href="classextract__snapshot.html" title="Extracting a snapshot configuration.">extract_snapshot</a> browses through the saved trajectory information from a run of a typical profasi simulation program like <a class="el" href="classBasicMCRun.html" title="Constant temperature Monte Carlo simulations.">BasicMCRun</a>, <a class="el" href="classSimTempRun.html" title="Simulated tempering with profasi.">SimTempRun</a> or <a class="el" href="classParTempRun.html" title="Parallel tempering class.">ParTempRun</a>, and extracts the state of the population at a requested point. The output could be a pdb file, an xml PROFASI structure description file, a text or binary structure file with only the population information.</p>
<p>Typically, because of job time limits on clusters and supercomputers, a simulation requires many restarts. Every stage of such a run opens a new binary data file with a name "conf..." inside the run directoy (n0,n1 etc.). In addition, with PROFASI version 1.5, there are trajectory metadata files called "traj" in the run directories. They store information about ranges, write intervals and number of blocks present in different conf files. For extraction of structures and properties, it is best to use these "traj" files, as input to this program. The traj files contain information about which binary file to open to look for the desired structure. But since they don't have any data as such, if you move the traj files, you should move all the corresponding "conf..." files along with it.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>PROFASI's binary configuration files store information in an assumed order. So, this program will not work if the configuration layout is changed. The original configuration files typically include random number generator information etc. in addition to the state of the population.</dd></dl>
<p>If the reason for extracting a structure is to start new runs using it, we recommend using the xml structure file for this, as it contains sequence information, and works as a self contained human readable record of the structure, unlike the textconf or the binary configuration files. Runs can be started with the xml configuration by using "set_population somefile.xml" command, while with the text configuration files, you would need to use the "add_chain ..." commands as well as "init_config" command. (See <a class="el" href="settings_population.html">Commands to set up the population</a> for more information on these commands.) <br/>
 <br/>
</p>
<h2><a class="anchor" id="syntax">
Syntax</a></h2>
<p><a class="el" href="classextract__snapshot.html" title="Extracting a snapshot configuration.">extract_snapshot</a> [OPTIONS] input_trajectory_file <br/>
 <br/>
 Options could be any of ...<br/>
 </p>
<ul>
<li><b>-o or --output_file </b> 1 argument, the filename </li>
<li><b>-f or --output_format </b> Here you choose whether the output is written in pdb, xml, text or binary configuration format. Possible values are pdb, xml, binary and textconf. </li>
<li><b>-c or --cycle_number </b> The Monte Carlo cycle number at which extraction is desired. </li>
<li><b>-i or --stdin </b> For extracting at given list of cycle numbers. In this mode, the program waits for the input of a list of cycle numbers from standard input, and when it reads EOF, it extracts a list of snapshots from each of those points. The cycle numbers are appended to the end of the corresponding output files. The intended use is to "pipe" in a set of cycle numbers to the extract program. </li>
<li><b>-r or --raw </b> This option is provided so that it is possible to work without the metadata file "traj", directly using the data. But it is inefficient and should be avoided. </li>
</ul>
<h2><a class="anchor" id="examples">
Examples</a></h2>
<div class="fragment"><pre class="fragment">
$ extract_snapshot -o min_at_1293999.pdb n19/traj -c 1293999
$ extract_snapshot -o min_at_1293999.xml n19/traj -c 1293999
$ extract_snapshot -o min_at_1293999.xml -c 1293999 --raw n0/conf.bkp0 conf.bkp2 conf.bkp1
</pre></div><p>In the above examples, we extract the state of the population at the cycle 1293999 and save the state as a pdb or xml file. The last example shows that it is possible to use the binary conf files directly with the raw option. It is possible, but not recommended for efficiency. The format of the data in the output file can be inferred from the suffix you provide. So, the "-f" option is unnecessary. In the following case, the "-f" option would be necessary:</p>
<div class="fragment"><pre class="fragment">
$ extract_snapshot -o weird_structure.whatonearth n0/traj -c 87999 -f pdb
</pre></div><p>Without the "-f pdb" option above, the file "weird_structure.whatonearth" would be written in the (default) xml format. When given, the option "-f" overrides any automatically inferred output file format.</p>
<p>In order to interpret the binary data in the conf files, information about the layout of data in these files is needed. From ProFASi version 1.5, this information is embedded in the binary files. In versions 1.1 to 1.5, this information was in a separate file called "conf.info" in the same directory as the conf file. For hints on extracting information from old runs, made with PROFASI versions without embedded layout information or conf.info files, see the section "Analysis of data generated by older PROFASI versions" in <a class="el" href="traj_gen.html">Generating trajectory files</a>.</p>
<p>The following (BASH) shell script will create files emin.xml corresponding to the minimum energy configurations from each of the runs n0...nN, and save them in the respective directories. Those population configurations can then be used to start a run with different initial configurations for each of the nodes. <br/>
 <br/>
</p>
<div class="fragment"><pre class="fragment">
$ for i in `seq 0 N` ; do
&gt; tx=`grep ENERGY n\$i/minen.pdb | awk '{print \$9;}' ` ;
&gt; extract_snapshot n\$i/traj -o n\$i/emin.xml -c \$tx ;
&gt; done
$
</pre></div><p>This works because PROFASI saves energy and Monte Carlo time information as remarks in its pdb output files when it can. Note that some of the quote marks above (used around the seq and grep commands) are back quotes. <br/>
<br/>
</p>
<p>Finally, note that if you see this line in the documentation, your version of <a class="el" href="classextract__snapshot.html" title="Extracting a snapshot configuration.">extract_snapshot</a> is capable of reading binary configurations written in other machines with different binary formats. If you made a run on a cluster of IBM PPC 6 processors, and want to analyze the data on your own laptop with an old Intel Pentium M in it, you don't have to convert the binaries. Use it directly:</p>
<p>$ <a class="el" href="classextract__snapshot.html" title="Extracting a snapshot configuration.">extract_snapshot</a> -o min_at_1293999.xml --raw n19/conf -c 1293999 <br/>
 <br/>
</p>
<p>The byte order information is part one of the things written in the header part of the binary files in recent versions and in the conf.info file in older versions of PROFASI. In the above, using the raw option is not inefficient, as there is only one conf segment. If the cycle 1293999 is found in it, it will be recovered.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classextract__props.html" title="Calculating run-time properties from traj files.">extract_props</a> </dd></dl>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>app/extract_snapshot.hh</li>
<li>app/extract_snapshot.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
