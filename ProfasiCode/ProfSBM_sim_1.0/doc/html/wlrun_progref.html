<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: Wang-Landau method with WLRun</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="toc.html">Table of contents</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="wlrun_progref">Wang-Landau method with <a class="el" href="classWLRun.html" title="Monte Carlo simulations with the Wang Landau method.">WLRun</a> </a></h1><p>The program <a class="el" href="classWLRun.html" title="Monte Carlo simulations with the Wang Landau method.">WLRun</a> performs Wang-Landau iterations. The basic algorithm is as described in "Fugao Wang and D.P. Landau, Physical Review Letters,
86 (10) 2050", with the following modifications:</p>
<ul>
<li>If the energy exceeds the given upper limit, an update is by default rejected. But if the flag --use_htmc is given, the update is accepted or rejected as if it was a Metropolis MC update with a high temperature. New Metropolis MC updates are done until the energy comes back into the specified range again. </li>
<li>For protein systems, it is not possible to know ahead of time what a good lower bound for energy should be. If the lower limit is set below what is possible for the given system, the simulation will never converge. Therefore, the simulations should be started with a conservative estimate of the lower bound. It is ok if it is too high. If the simulation finds a state with energy lower than the lower bound, it is not rejected. It is kept, and the lower bound is adjusted by adding new bins until the range includes the newly found state. If the range is changed, the density of states must now be determined over a wider range. The simulation continues with the existing estimate of the density of states for the pre-existing bins.</li>
</ul>
<p>As of now, the Wang Landau algorithm is less well tested in ProFASi than the other simulation algorithms. Please carefully check the code and test it thoroughly before using it for anything serious. Of course, if you find a bug or improve its performance, we would like to know.</p>
<h2><a class="anchor" id="options">
Available options</a></h2>
<p>This implementation uses the program <a class="el" href="classBasicMCRun.html" title="Constant temperature Monte Carlo simulations.">BasicMCRun</a> as a base class. Most options available for <a class="el" href="classBasicMCRun.html" title="Constant temperature Monte Carlo simulations.">BasicMCRun</a> can be used for <a class="el" href="classWLRun.html" title="Monte Carlo simulations with the Wang Landau method.">WLRun</a>. In particular setting up the protein population, updates etc. proceeds exactly as in <a class="el" href="classBasicMCRun.html" title="Constant temperature Monte Carlo simulations.">BasicMCRun</a>. In addition to those options, this program accepts </p>
<ul>
<li><a class="el" href="wlopts.html">Extra options for Wang Landau iterations</a> </li>
</ul>
<h2><a class="anchor" id="Example">
Example</a></h2>
<div class="fragment"><pre class="fragment">
$ WLRun --energy_range 20 70 --n_bins 50 -htmc --n_stages 10 \
  --add_chain 1 "*GEWTYDDATKTFTVTE*" -ncyc 1000000 -lcyc -1 -time 9:00:00
</pre></div><p> This is how the above configures a Wang-Landau run: </p>
<ul>
<li>The energy histogram is initially between 10 and 70 profasi units </li>
<li>The histogram initially has 50 bins. It will grow when lower energy states are found. </li>
<li>It will use the high temperature MC method to put back a trajectory which exits the given range on the higher side. </li>
<li>It will try to perform 10 rounds of refinement of the Wang-Landau update factor f: f--&gt;sqrt(f). </li>
<li>The population will contain 1 chain of sequence "*GEWTYDDATKTFTVTE*". The initial and final asterix ("*") symbols are toggle markers in ProFASi to switch back and forth between 3 letter codes and one letter codes for residues. The same sequence could be written without the asterixes as "GLY GLU TRP THR TYR
ASP ASP ALA THR LYS THR PHE THR VAL THR GLU". </li>
<li>The run will have 1000000 Monte Carlo sweeps, unless it converges before that. </li>
<li><b>-lcyc</b> <b></b>-1 : Each sweep will consist of as many MC updates as there are degrees of freedom in the system. You could write -lcyc 100 to force 100 updates per sweep. The value -1 is a convenient shorthand for the number of degrees of freedom in the current system. </li>
<li>The run will suspend automatically if it is not finished within 9 hours. </li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
