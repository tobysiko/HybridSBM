<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf::ProteinRMSD Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf.html">prf</a>::<a class="el" href="classprf_1_1ProteinRMSD.html">ProteinRMSD</a>
  </div>
</div>
<div class="contents">
<h1>prf::ProteinRMSD Class Reference<br/>
<small>
[<a class="el" href="group__profasi__observables.html">Measurements</a>]</small>
</h1><!-- doxytag: class="prf::ProteinRMSD" --><!-- doxytag: inherits="prf::Observable" -->
<p><a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> evaluator between a file and a collection of atoms in the program.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;ProteinRMSD.hh&gt;</code></p>

<p>Inherits <a class="el" href="classprf_1_1Observable.html">prf::Observable</a>.</p>

<p><a href="classprf_1_1ProteinRMSD-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7a8cf8b9c5cff64528090b54d8755355"></a><!-- doxytag: member="prf::ProteinRMSD::ProteinRMSD" ref="a7a8cf8b9c5cff64528090b54d8755355" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a7a8cf8b9c5cff64528090b54d8755355">ProteinRMSD</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#ab8fbca534ded6ab73f19e9e380382a70">init_obs</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">All observables must implement one initialize routine.  <a href="#ab8fbca534ded6ab73f19e9e380382a70"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a72e792700e8c8a7e8e16bd38e56cf0d2"></a><!-- doxytag: member="prf::ProteinRMSD::set_struc1" ref="a72e792700e8c8a7e8e16bd38e56cf0d2" args="(std::string rf)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a72e792700e8c8a7e8e16bd38e56cf0d2">set_struc1</a> (std::string rf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the first structure, see the discussion at the class description. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab380453f9333b674d3da5978c32377b9"></a><!-- doxytag: member="prf::ProteinRMSD::set_struc2" ref="ab380453f9333b674d3da5978c32377b9" args="(std::string rf)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#ab380453f9333b674d3da5978c32377b9">set_struc2</a> (std::string rf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the second structure. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae66b04313dd0c732168046ddc74f7167"></a><!-- doxytag: member="prf::ProteinRMSD::set_default_sel1" ref="ae66b04313dd0c732168046ddc74f7167" args="(std::string s1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#ae66b04313dd0c732168046ddc74f7167">set_default_sel1</a> (std::string s1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set default selection. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a598ca9a94924448ab203a579322d34a2"></a><!-- doxytag: member="prf::ProteinRMSD::live_first_struc" ref="a598ca9a94924448ab203a579322d34a2" args="(bool tf=true)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a598ca9a94924448ab203a579322d34a2">live_first_struc</a> (bool tf=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare the first structure as changable. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa89cf22a113ec3075729a326342f1e5f"></a><!-- doxytag: member="prf::ProteinRMSD::filter" ref="aa89cf22a113ec3075729a326342f1e5f" args="(std::string flt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#aa89cf22a113ec3075729a326342f1e5f">filter</a> (std::string flt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a filter for the kind of atoms to be used in the <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> calculation. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a39e8b1186775ebace80610d6b4d21cf2">no_seq_align</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Don't try to align sequences.  <a href="#a39e8b1186775ebace80610d6b4d21cf2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a161e0097b995d2e680c37a19b0695861">returnQ</a> (bool tf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If called with "true", the observable value becomes exp(-MSD/100).  <a href="#a161e0097b995d2e680c37a19b0695861"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c18b431e03c57b7cd8b0bece2a8e5f7"></a><!-- doxytag: member="prf::ProteinRMSD::rangeEstimate" ref="a2c18b431e03c57b7cd8b0bece2a8e5f7" args="(double &amp;x1, double &amp;x2)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a2c18b431e03c57b7cd8b0bece2a8e5f7">rangeEstimate</a> (double &amp;x1, double &amp;x2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Estimate range for <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac02631cd12d3d3c55fb046de5ac305e7"></a><!-- doxytag: member="prf::ProteinRMSD::init" ref="ac02631cd12d3d3c55fb046de5ac305e7" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#ac02631cd12d3d3c55fb046de5ac305e7">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize with selected ranges and filter. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a7884dc01dbe01997236b127b84b1f959">delete_matrix2</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete information for the second object.  <a href="#a7884dc01dbe01997236b127b84b1f959"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6bc184c6da89820a2c920ffc4a37be3d"></a><!-- doxytag: member="prf::ProteinRMSD::evaluate" ref="a6bc184c6da89820a2c920ffc4a37be3d" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1ProteinRMSD.html#a6bc184c6da89820a2c920ffc4a37be3d">evaluate</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Actual calculation of the value of the observable. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is an "Observable" class which facilitates <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> evaluation from a structure in a PDB file with a structure in the program. Neither the structrue in the file nor in the program need to be complete Proteins.</p>
<p>The two comparison structures are built in a flexible way. One can select non-overlapping regions in the PDB file as follows:<br/>
<br/>
 <a class="el" href="classprf_1_1ProteinRMSD.html" title="RMSD evaluator between a file and a collection of atoms in the program.">ProteinRMSD</a> myrmsd;<br/>
 myrmsd.set_struc1("abc.pdb:7:A,12,19:A,25,45");<br/>
<br/>
 "abc.pdb" is the name of the reference pdb file. The MODEL 7 in that file is selected. In that model, the residues 12-19 and 25-45 of chain A are selected. The set of all selected atoms constitutes the comparison structure. Any number of segments can be selected, and they need not be from the same chain. But they have to be from the same MODEL. The model id can be omitted, so that it defaults to the first model. If residue range is not specified, the entire chain is selected. <br/>
</p>
<p>The convention for residue range specification here is different from the rest of PROFASI. The range 12-19 above means the residues labeled as 12 through 19 (inclusive at both ends) in the file. In case the residue numbering in the file jumps from 13 to 16, the selection would include residues 12,13,16,17,18,19. It is precisely to deal with pdb files with omitted residues or with insertion codes, that the residue number labels are merely treated as strings.</p>
<p>A corresponding comparison object can be created from the PROFASI <a class="el" href="classprf_1_1Population.html" title="A population of proteins.">Population</a>. The syntax is exactly the same, but instead of the file name, one uses the symbol $. For example, <br/>
 myrmsd.set_struc2("$::A,12,19:A,25,45");<br/>
<br/>
 Notice that the numbering here starts from 1, to keep it consistent with the selection numbering in pdb files.</p>
<p>It is possible to set both struc1 and struc2 to be simulated segments in the program, instead of some external pdb file. For instance, one might be interested in the similarity between the corresponding segments in chain A and chain C in the program, without reference to any external pdb file, like...</p>
<p>myrmsd.set_struc1("$::A,1,15");<br/>
<br/>
 myrmsd.set_struc2("$::C,1,15");<br/>
<br/>
</p>
<p>One does not always want to include all the atoms in the selected segments for an <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> calculations. To filter only the interesting ones, there are, well, filters! To use the backbone atoms and CB atoms only, you would write,</p>
<p>myrmsd.filter("+BB+CB"); <br/>
 If you additionally want to exclude proline residues and sulfur atoms from the calculations, then you would write instead,<br/>
</p>
<p>myrmsd.filter("+BB+CB-%PRO-@S");<br/>
</p>
<p>It is assumed by default that the first of the two structures does not change during the simulation. This is normally the case, like when it is an NMR derived PDB file. Some calculations related to that structure are done only once. If you use the population as the source of the first structure, by default, it would mean the state of the population at the time of invocation of <a class="el" href="classprf_1_1ProteinRMSD.html#ac02631cd12d3d3c55fb046de5ac305e7" title="Initialize with selected ranges and filter.">ProteinRMSD::init</a>. If on the other hand, you wish a genuine changing state to be compared with another changing state, you have to declare the first state to be mobile, using the following function.</p>
<p>myrmsd.mobile_first_struc();</p>
<p>Finally, you need the <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> value for whatever selections and filters you made. This is done in the usual way, as in all other classes derived from <a class="el" href="classprf_1_1Observable.html" title="An observable is in principle anything that is named and has a value.">Observable</a>, call <a class="el" href="classprf_1_1Observable.html#a84e30afbde076bf032e2a642b0ea0c0f" title="Necessary before an observable value is used.">refresh()</a>, and then <a class="el" href="classprf_1_1Observable.html#ac7ce7840ae6d4b5fc32abe9adbb6b2bc" title="Retrieve the value of the observable.">Value()</a>; //available through inheritance.</p>
<p>myrmsd.refresh(); x=myrmsd.<a class="el" href="classprf_1_1Observable.html#ac7ce7840ae6d4b5fc32abe9adbb6b2bc" title="Retrieve the value of the observable.">Value()</a>; </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a7884dc01dbe01997236b127b84b1f959"></a><!-- doxytag: member="prf::ProteinRMSD::delete_matrix2" ref="a7884dc01dbe01997236b127b84b1f959" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prf::ProteinRMSD::delete_matrix2 </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This should be called if you wish to call init over and over again, with new files for the second structure. </p>

</div>
</div>
<a class="anchor" id="ab8fbca534ded6ab73f19e9e380382a70"></a><!-- doxytag: member="prf::ProteinRMSD::init_obs" ref="ab8fbca534ded6ab73f19e9e380382a70" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prf::ProteinRMSD::init_obs </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Even if it seems that one particular observable might need additional arguments during initialization, it is advantageous to have a uniform syntax for all of them. So, when additional arguments are needed, one should provide them in a separate function called before initialization, and then call init_obs without arguments. The name init_obs instead of a more natural "init" or "initialize" is because an <a class="el" href="classprf_1_1Observable.html" title="An observable is in principle anything that is named and has a value.">Observable</a> often inherits from other classes which represent its character more fundamentally. So, the names such as "init" are kept free for such base classes. </p>

<p>Reimplemented from <a class="el" href="classprf_1_1Observable.html#a75c0338181f981847cc1d45e1e8a58b8">prf::Observable</a>.</p>

</div>
</div>
<a class="anchor" id="a39e8b1186775ebace80610d6b4d21cf2"></a><!-- doxytag: member="prf::ProteinRMSD::no_seq_align" ref="a39e8b1186775ebace80610d6b4d21cf2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prf::ProteinRMSD::no_seq_align </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>With this option, the program does not try to align sequences. It is useful, in combination with appropriate filters, to calculate <a class="el" href="classprf_1_1RMSD.html" title="Root Mean Square Deviation.">RMSD</a> between similar but not identical sequences. </p>

</div>
</div>
<a class="anchor" id="a161e0097b995d2e680c37a19b0695861"></a><!-- doxytag: member="prf::ProteinRMSD::returnQ" ref="a161e0097b995d2e680c37a19b0695861" args="(bool tf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prf::ProteinRMSD::returnQ </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>tf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The quantity Q=exp(-RMSD^2 /100) has a range between 0 and 1 and has been found useful. We include an option for the <a class="el" href="classprf_1_1Observable.html#ac7ce7840ae6d4b5fc32abe9adbb6b2bc" title="Retrieve the value of the observable.">Value()</a> function to return this. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Observables/ProteinRMSD.hh</li>
<li>model/Observables/ProteinRMSD.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
