<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf::MC Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf.html">prf</a>::<a class="el" href="classprf_1_1MC.html">MC</a>
  </div>
</div>
<div class="contents">
<h1>prf::MC Class Reference<br/>
<small>
[<a class="el" href="group__MCalgorithms.html">Monte Carlo algorithms</a>]</small>
</h1><!-- doxytag: class="prf::MC" --><!-- doxytag: inherits="HandlerBase" -->
<p><a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class handles the Markov Chain Monte Carlo evolution.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;MC.hh&gt;</code></p>

<p>Inherits HandlerBase.</p>

<p>Inherited by prf::GMC.</p>

<p><a href="classprf_1_1MC-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a42d26bd270270ea5788dcc421543d991"></a><!-- doxytag: member="prf::MC::MC" ref="a42d26bd270270ea5788dcc421543d991" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a42d26bd270270ea5788dcc421543d991">MC</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">default constructor <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f4b6d15d9530bb31e982f27c1a8ae4d"></a><!-- doxytag: member="prf::MC::updates_hander" ref="a6f4b6d15d9530bb31e982f27c1a8ae4d" args="()" -->
<a class="el" href="classUpdatesHandler.html">UpdatesHandler</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a6f4b6d15d9530bb31e982f27c1a8ae4d">updates_hander</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return pointer to the manager of conformational updates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70fef81080ce7680178249a35d2f2706"></a><!-- doxytag: member="prf::MC::forcefield_handler" ref="a70fef81080ce7680178249a35d2f2706" args="()" -->
FFHandler *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a70fef81080ce7680178249a35d2f2706">forcefield_handler</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return pointer to the force field manager. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a816f3d4e0ee016d9f8a69ff9960cbf9c"></a><!-- doxytag: member="prf::MC::forcefield_handler" ref="a816f3d4e0ee016d9f8a69ff9960cbf9c" args="(FFHandler *fh)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a816f3d4e0ee016d9f8a69ff9960cbf9c">forcefield_handler</a> (FFHandler *fh)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Introduce the force field manager. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad967db2997e30338c2913cbfa3d837c3"></a><!-- doxytag: member="prf::MC::RandomNumberGenerator" ref="ad967db2997e30338c2913cbfa3d837c3" args="()" -->
<a class="el" href="classprf_1_1RandomNumberBase.html">RandomNumberBase</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#ad967db2997e30338c2913cbfa3d837c3">RandomNumberGenerator</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a pointer to the random number generator for other use. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8fa09a5b6cd5c0747da10f3a3c6ad992"></a><!-- doxytag: member="prf::MC::RandomNumberGenerator" ref="a8fa09a5b6cd5c0747da10f3a3c6ad992" args="(RandomNumberBase *grn)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a8fa09a5b6cd5c0747da10f3a3c6ad992">RandomNumberGenerator</a> (<a class="el" href="classprf_1_1RandomNumberBase.html">RandomNumberBase</a> *grn)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Force use of a different a random number generator. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d430a4eba86ddf3a4155e1316dfc990"></a><!-- doxytag: member="prf::MC::temperature" ref="a3d430a4eba86ddf3a4155e1316dfc990" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a3d430a4eba86ddf3a4155e1316dfc990">temperature</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get temperature in dimensionless ProFASi units. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afeb33d3e356d332f114336bc110337a1"></a><!-- doxytag: member="prf::MC::temperature" ref="afeb33d3e356d332f114336bc110337a1" args="(double x)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#afeb33d3e356d332f114336bc110337a1">temperature</a> (double x)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set temperature in dimensionless ProFASi units. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30bd0c955cc3ef7a17757b7982505858"></a><!-- doxytag: member="prf::MC::temperature_in_kelvin" ref="a30bd0c955cc3ef7a17757b7982505858" args="() const " -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a30bd0c955cc3ef7a17757b7982505858">temperature_in_kelvin</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> temperature in Kelvin. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a5d640e1632f43a99dac1c7bedb5c15"></a><!-- doxytag: member="prf::MC::temperature_in_kelvin" ref="a6a5d640e1632f43a99dac1c7bedb5c15" args="(double val)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a6a5d640e1632f43a99dac1c7bedb5c15">temperature_in_kelvin</a> (double val)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assign a temperature in kelvin for the simulation. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a96a64856c19641f637b9831c0ac8005c"></a><!-- doxytag: member="prf::MC::SetBeta" ref="a96a64856c19641f637b9831c0ac8005c" args="(double be)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a96a64856c19641f637b9831c0ac8005c">SetBeta</a> (double be)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set inverse temperature (model units for temperature). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a031ec2d04a996329e87edd99bfac2c63"></a><!-- doxytag: member="prf::MC::Connect" ref="a031ec2d04a996329e87edd99bfac2c63" args="(Population *p)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a031ec2d04a996329e87edd99bfac2c63">Connect</a> (<a class="el" href="classprf_1_1Population.html">Population</a> *p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tell <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> what population of proteins it needs to evolve. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a7091916172bce3c5b676ca610d8f5781">Setup</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize.  <a href="#a7091916172bce3c5b676ca610d8f5781"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a06f8790f36ef423b5838d06a72608a75">SimpleStep</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform one Monte Carlo step: naive version.  <a href="#a06f8790f36ef423b5838d06a72608a75"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#aa7bdaef91fd5099a7bec843a810a2ac0">Step</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">One Monte Carlo Step, as used in PROFASI.  <a href="#aa7bdaef91fd5099a7bec843a810a2ac0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae4ec55246cdbddc81e0cb22aab2529ab"></a><!-- doxytag: member="prf::MC::Step" ref="ae4ec55246cdbddc81e0cb22aab2529ab" args="(int nstps)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#ae4ec55246cdbddc81e0cb22aab2529ab">Step</a> (int nstps)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform nstps Monte Carlo steps. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#aa06f53dd294eaf4e36dfcb8d942221f5">RunCycle</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run a Monte Carlo cycle or sweep.  <a href="#aa06f53dd294eaf4e36dfcb8d942221f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a401cfbf7aa66db4b5017ac0f3e0589ba">SetCycleLength</a> (int i)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set length of cycle to i.  <a href="#a401cfbf7aa66db4b5017ac0f3e0589ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1MC.html#a116448c0b727d5fc1977f354cb59b68d">parseCommand</a> (InstructionString s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute an instruction.  <a href="#a116448c0b727d5fc1977f354cb59b68d"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class accumulates information about the force field and updates and the population of proteins. It then performs the Markov Chain evolution of that system, using predefined probabilities for the updates. <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> as such performs only fixed-temperature simulations. For most practical purposes this would be inadequate. But it works as a good base class for other methods such as the Simulated Tempering (SimTemp class) or Simulated Annealing (SimAnneal class).</p>
<p>The acceptance probability for a proposed update is very much like the Metropolis probability, but with a prefactor. For certain updates, like <a class="el" href="classprf_1_1BGS.html" title="Biased Gaussian Steps.">BGS</a>, it is necessary to use an additional factor in the probability to ensure detail balance.</p>
<p>In version 1.5 handling of energy terms is delegated to a new force field handler class, FFHandler. Similarly operations relating to the conformational updates are delegated to the <a class="el" href="classUpdatesHandler.html" title="A manager for MC updates.">UpdatesHandler</a>. Both these handlers are members of the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class. Using the handler classes help maintain a modular structure in the code. These measures are also the first step towards making <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> algorithms such as parallel tempering, simulated tempering or simulated annealing available as a pure template library, independent of the rest of ProFASi. Such a library could be useful for arbitrary systems not necessarily related to proteins.</p>
<p>Another change relative to earlier versions of ProFASI, made to bring the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class closer to a pure representation of the Markov chain Monte Carlo algorithm was to rid it of the responsibility of keeping track of the number of temperatures and the temperature index for simulated tempering, parallel tempering and simulated annealing. Although these variables are common to these three algorithm, they do not belong to the concept of the basic Monte Carlo algorithm. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a116448c0b727d5fc1977f354cb59b68d"></a><!-- doxytag: member="prf::MC::parseCommand" ref="a116448c0b727d5fc1977f354cb59b68d" args="(InstructionString s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MC::parseCommand </td>
          <td>(</td>
          <td class="paramtype">InstructionString&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class handles some instructions of its own, as well as forwarding instructions meant for the <a class="el" href="classUpdatesHandler.html" title="A manager for MC updates.">UpdatesHandler</a>. Instructions for the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class are: </p>
<ul>
<li><b> steps_per_cycle : </b> Sets how many Monte Carlo updates constitute a Monte Carlo cycle. Example: steps_per_cylce 100 </li>
<li><b> random_number_seed : </b> Manually set a random number seed. </li>
<li><b> temperature </b> Temperature for the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> simulation. Example: temperature 310 Kelvin, or temperature 0.485. If no unit is given, temperature is read in the dimensionless ProFASi units. </li>
<li><b> ntmp </b> Number of temperatures (mostly relevant for methods derived from Metropolis Monte Carlo) Example: ntmp 10 </li>
</ul>

<p>Reimplemented in <a class="el" href="classprf_1_1ParTemp.html#a1948a9fce0338bf4ed8dde4e3b6bb057">prf::ParTemp</a>, and <a class="el" href="classprf_1_1WangLandau.html#aa3ab49a5da0320e89c76e808f6cd0c5c">prf::WangLandau</a>.</p>

</div>
</div>
<a class="anchor" id="aa06f53dd294eaf4e36dfcb8d942221f5"></a><!-- doxytag: member="prf::MC::RunCycle" ref="aa06f53dd294eaf4e36dfcb8d942221f5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prf::MC::RunCycle </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A Monte Carlo sweep or cycle consists of a pre-configured number of Monte Carlo steps. The default number of steps ( ProFASi v 1.5 ) is the number of degrees of freedom in the population. This may be changed to any value using the command "steps_per_cycle N". This function is a short-hand to call <a class="el" href="classprf_1_1MC.html#aa7bdaef91fd5099a7bec843a810a2ac0" title="One Monte Carlo Step, as used in PROFASI.">Step()</a> many times. </p>

</div>
</div>
<a class="anchor" id="a401cfbf7aa66db4b5017ac0f3e0589ba"></a><!-- doxytag: member="prf::MC::SetCycleLength" ref="a401cfbf7aa66db4b5017ac0f3e0589ba" args="(int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MC::SetCycleLength </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If a positive value is passed, cycle length is set to that value. If a negative number or 0 is passed, cycle length is set equal to the number of degrees of freedom in the system. </p>

</div>
</div>
<a class="anchor" id="a7091916172bce3c5b676ca610d8f5781"></a><!-- doxytag: member="prf::MC::Setup" ref="a7091916172bce3c5b676ca610d8f5781" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MC::Setup </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>After this function, the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> object should be ready to do Monte Carlo steps. </p>

<p>Reimplemented in <a class="el" href="classprf_1_1ParTemp.html#a0bd2acfa90619fe2f6b1b6d76448bd1e">prf::ParTemp</a>.</p>

</div>
</div>
<a class="anchor" id="a06f8790f36ef423b5838d06a72608a75"></a><!-- doxytag: member="prf::MC::SimpleStep" ref="a06f8790f36ef423b5838d06a72608a75" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MC::SimpleStep </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Select an update. Find energy change. Ask the Metropolis question. Decide whether or not to accept the update, and do so.This function, is not used in ProFASi, except during debugging. </p>

</div>
</div>
<a class="anchor" id="aa7bdaef91fd5099a7bec843a810a2ac0"></a><!-- doxytag: member="prf::MC::Step" ref="aa7bdaef91fd5099a7bec843a810a2ac0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MC::Step </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Similar to the SimpleStep function, but with a speed up trick. The random number to be used for the Metropolis question is completely independent of the energy calculations. In this version of the Monte Carlo step, that random number is generated before the energy calculations (but after the conformational update). Using it, and the temperature, a maximum acceptable energy increase is calculated before doing anything with the energy terms. This value is passed to the force field handler for the delta E calculations. It is understood that if the energy change is greater than this limit, it need not be calculated precisely. The conformational update will be rejected anyway! So, the FFHandler gets a license to return any (too) large value, if it has ascertained that the correct value lies beyond the limit passed to it. See the documentation of the deltaE_with_limit() function in FFHandler for a little more on this. </p>

<p>Reimplemented in <a class="el" href="classprf_1_1WangLandau.html#a1b5c5569ff5f473636236d3653db4ebf">prf::WangLandau</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Algorithms/MC.hh</li>
<li>model/Algorithms/MC.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
