<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf::AtomLabelDictionary Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf.html">prf</a>::<a class="el" href="classprf_1_1AtomLabelDictionary.html">AtomLabelDictionary</a>
  </div>
</div>
<div class="contents">
<h1>prf::AtomLabelDictionary Class Reference</h1><!-- doxytag: class="prf::AtomLabelDictionary" -->
<p>A translator for atom labels from other conventions.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;AtomLabelDictionary.hh&gt;</code></p>

<p><a href="classprf_1_1AtomLabelDictionary-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32dcc7e52f1dac9ddc37b924fbc4352c"></a><!-- doxytag: member="prf::AtomLabelDictionary::interpret" ref="a32dcc7e52f1dac9ddc37b924fbc4352c" args="(std::string three_letter_code, std::string &amp;atomlabel)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1AtomLabelDictionary.html#a32dcc7e52f1dac9ddc37b924fbc4352c">interpret</a> (std::string three_letter_code, std::string &amp;atomlabel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interpret for a given residue what atomlabel means. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ff8c160fcef66e194838b201009f550"></a><!-- doxytag: member="prf::AtomLabelDictionary::interpret" ref="a6ff8c160fcef66e194838b201009f550" args="(prf::OneLetterCode olc, std::string &amp;atomlabel)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1AtomLabelDictionary.html#a6ff8c160fcef66e194838b201009f550">interpret</a> (prf::OneLetterCode olc, std::string &amp;atomlabel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interpret for a give residue what atomlabel means. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1AtomLabelDictionary.html#abe6bed6219ac214906c727aebab5d57b">learn</a> (std::vector&lt; std::set&lt; std::string &gt; &gt; &amp;new_labels)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Learn new labels from a bunch of label sets, one for each kind of residue.  <a href="#abe6bed6219ac214906c727aebab5d57b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Sometimes, one encounters atom labels that are not consistent with conventions used in ProFASi. This happens in particular for hydrogen atoms, as there are lots and lots of different ways people label them in PDB files.</p>
<p>Here is the ProFASi convention: (i) A hydrogen atom is labeled with the character 'H' and two indices. (ii) The first index, a subscript, is the same as the index of the heavy atom it is attached to. The subscript is written immediately to the write of the atom type label 'H'. For instance, the index 'A' in "HA" is derived from the heavy atom attached to the HA: "CA". (ii) In case there are more than one hydrogen atoms attached to the same heavy atom, they are to be distinguished with a second index, a superscript. Superscripts are written to the left of the atom type label 'H'. Superscript numbering starts from 1.</p>
<p>Notice that there can not be a label "HG11" or " HB3" with this convention. The two indices attached to the hydrogen are fundamentally of different kinds, and we insist that they should be written on different sides of the 'H' for clarity.</p>
<p>Since we nevertheless want to be able to read PDB files generated by other programs, this class provides a translation to the ProFASi conventions. Some labels, like "HG11" are easily interpreted: perform a cyclic rotation of these characters to put the 'H' at the right place. But this does not work. In many cases, when there are two hydrogen atoms, for instance attached to a CB atom, they are labeled " HB2" and " HB3", i.e., the numbering is not meant to describe the hydrogens alone. Also, some translations have to be residue specific.</p>
<p>Therefore, all translations will be done using a simple table look up. There is a <a class="el" href="classprf_1_1AtomLabelDictionary.html#abe6bed6219ac214906c727aebab5d57b" title="Learn new labels from a bunch of label sets, one for each kind of residue.">learn()</a> function which can be used to train the dictionary to recognize new labels. The updated dictionary is then saved as a file ".profasi_dictionary" in the user's home directory. The next time the same label is encountered, the learned value is used. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="abe6bed6219ac214906c727aebab5d57b"></a><!-- doxytag: member="prf::AtomLabelDictionary::learn" ref="abe6bed6219ac214906c727aebab5d57b" args="(std::vector&lt; std::set&lt; std::string &gt; &gt; &amp;new_labels)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prf::AtomLabelDictionary::learn </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::set&lt; std::string &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>new_labels</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The size of the vector should be Groups::max_grp, or the total number of different Ligands/groups known to ProFASi. It's elements are accessed using the one letter codes for the groups. For each group there is a set of labels which can be interactively modified. Often, many of these lists would be empty. For each residue with a non-empty list of labels, the user is presented with a list of labels understood by ProFASi. The user then maps the unknown labels to known labels. The user chooses when editing stops and the function quits. The return value is the actual number of changes due to the user interaction. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Aux/AtomLabelDictionary.hh</li>
<li>model/Aux/AtomLabelDictionary.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
