<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: prf::WangLandau Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceprf.html">prf</a>::<a class="el" href="classprf_1_1WangLandau.html">WangLandau</a>
  </div>
</div>
<div class="contents">
<h1>prf::WangLandau Class Reference</h1><!-- doxytag: class="prf::WangLandau" --><!-- doxytag: inherits="prf::GMC" -->
<p>Wang Landau iterations.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;WangLandau.hh&gt;</code></p>

<p>Inherits prf::GMC.</p>

<p><a href="classprf_1_1WangLandau-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa3ab49a5da0320e89c76e808f6cd0c5c"></a><!-- doxytag: member="prf::WangLandau::parseCommand" ref="aa3ab49a5da0320e89c76e808f6cd0c5c" args="(InstructionString s)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1WangLandau.html#aa3ab49a5da0320e89c76e808f6cd0c5c">parseCommand</a> (InstructionString s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse commands specific to the Wang Landau algorithm. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b5c5569ff5f473636236d3653db4ebf"></a><!-- doxytag: member="prf::WangLandau::Step" ref="a1b5c5569ff5f473636236d3653db4ebf" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classprf_1_1WangLandau.html#a1b5c5569ff5f473636236d3653db4ebf">Step</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modify the <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> step so that it perform Wang Landau updates. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is an <a class="el" href="classprf_1_1MC.html" title="MC class handles the Markov Chain Monte Carlo evolution.">MC</a> class derivative that redefines how the "Step" function works to implement the Wang Landau iterations. The acceptance probability for an update, which changes the energy from E1 to E2, is g(E1)/g(E2), where g(E) is an estimate of the density of states. The class keeps a histogram for this density of states and uses that in the Monte Carlo steps. A special feature of the Wang-Landau algorithm is that this estimate of the density of states is updated "live" during the simulation. The algorithm can be roughly described like this: <br/>
<br/>
 </p>
<ol>
<li>
System is initialized randomly with an energy somewhere within the range </li>
<li>
A histogram of energy, H, is initialized in the range emin,emax  </li>
<li>
Another histogram to store g(E) is initialized in the same range, but with every bin set to 1.  </li>
<li>
A conformational update is performed </li>
<li>
Energies before and after the update are estimated </li>
<li>
Wang Landau acceptance criterion is applied, and the update is either accepted or rejected </li>
<li>
At the end of every update, g(Ei) for the bin corresponding to the energy of the system is multiplied by a certain factor, f.  </li>
<li>
The appropriate bin of that histogram H is icremented by 1  </li>
<li>
The last 5 steps are repeated until a certain convergence criterion is met, defined as a certain degree of flatness of the occupation histogram.  </li>
<li>
The factor f is reduced, and the occupation histogram (but not the estimate of g) is reset to zero </li>
<li>
Simulation continues from step 4, unless the factor f is already below a preset final value. </li>
</ol>
<p>If the energy found is below the minimum in the range, the range is extended to accommodate the new value. Lower energy values are always interesting. If the update produces a new energy higher than the maximum, some heuristics is needed to bring it to within the range. This implementation can perform a series of high temperature Monte Carlo steps until the system re-enters the relevant range. This feature must be invoked with the switch --use_htmc. </p>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>model/Algorithms/WangLandau.hh</li>
<li>model/Algorithms/WangLandau.cc</li>
</ul>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
