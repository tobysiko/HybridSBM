<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PROFASI: Generating native contact lists</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="toc.html">Table of contents</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="contactgen">Generating native contact lists </a></h1><p>The program <code>generate_contact_file</code> can be used to generate a list of contacts found in a structure. Such a file can be used to initialize a <a class="el" href="classprf_1_1ContactMap.html" title="Utility to help keep track of a set of contacts.">prf::ContactMap</a> observable, to monitor the on/off state of native contacts through a run.</p>
<h2><a class="anchor" id="contactgen_1">
Types of contact maps in PROFASI</a></h2>
<p>For the purpose of contact map measurements, "contact" in PROFASI is between two residues. Therefore it can be enumerated by two integers corresponding to their unique serial numbers in the population. The following types of contacts are available by default: </p>
<ul>
<li><em>CaContact</em> : the <img class="formulaInl" alt="$C_\alpha$" src="form_3.png"/> atoms of the residues are within a cut-off distance </li>
<li><em>HvContact</em> : at least one heavy atom in one residue is within a cut-off distance of a heavy atom in the other residue </li>
<li><em>Proximity</em> : there exist at least two pairs of heavy atoms, such that atoms in a pair do not come from the same residue, and are within a cut-off distance </li>
<li><em>HBContact</em> : there is a backbone hydrogen bond from the NH of the left-hand residue to the CO of the right-hand residue. Note that it is asymmetric! </li>
<li><em>HPContact</em> : there is a hydrophobic contact between the residues</li>
</ul>
<h2><a class="anchor" id="contactgen_2">
Typical usage</a></h2>
<p>Given a PDB file <code>abc.pdb</code>, you can find the hydrogen bond contacts in it like this:</p>
<div class="fragment"><pre class="fragment">
  generate_contact_file -ct HBContact -o result.dat abc.pdb
  </pre></div><p>If the PDB file contains the structure of a large protein and you are interested in the internal contacts of a segment between residues 50--100, you can do this:</p>
<div class="fragment"><pre class="fragment">
  generate_contact_file -ct HBContact -o result.dat abc.pdb -sl :A,50,100
  </pre></div><p>In the above, we gave the selections differently compared to PROFASI programs like mimiqa. To select residues 50 to 100 in chain A of file <code>abc.pdb</code> in <code>mimiqa</code>, we would write <code>abc.pdb:1</code>:A,50,100. The syntax for the selections for <code>generate_contact_file</code> is in fact the same. But one has to specify the selection string separately with the <code>-sl</code> option. Think of the mimiqa filename-selection combination as <code>filename:selection_string</code>. For <code>generate_contact_file</code>, we need the <code>selection_string</code> part. That would have been <code>1</code>:A,50,100 above, but if we are happy to use the first model in the PDB file, we can omit the model identifier <code>1</code> here. This explains the string <code></code>:A,50,100 above.</p>
<p>The reason for the separate option <code>-sl</code> for selections is that it can be applied to a bunch of PDB files together. The program then looks for preserved contacts in all those files. Something like this: </p>
<div class="fragment"><pre class="fragment">
  generate_contact_file -ct HBContact -o result.dat abc_*.pdb -sl :A,50,100
  </pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The directionality of the hydrogen bond potential in PROFASI means that the HBContact measure may miss many hydrogen bonds in a PDB file, typically refined with some other force field. To find all hydrogen bonds, it is better to first regularize the structure (See <a class="el" href="regul.html">Regularization: approximating a protein structure</a>), and take the resulting energy minimized structure file as input. The XML output files of the <a class="el" href="classregularizer.html" title="A program to regularize PDB structures.">regularizer</a> may be converted to a PDB file with prf_convert if you want to use selections like in the examples above.</dd></dl>
<h2><a class="anchor" id="contactgen_exls">
Example with output</a></h2>
<p>Let's take a concrete example: the C-terminal hairpin of protein G, and generate the native hydrogen bond contacts. This hairpin has been studied as an excised peptide in experiments and numerous simulations. Download 1GB1.pdb from the PDB. The hairpin consists of residues 41--56 of the only chain in this structure.</p>
<p>First, let's cut out the relevant residues into a new PDB file. </p>
<div class="fragment"><pre class="fragment">
  pdb_slices 1GB1.pdb::A,41,56 -o hairpin.pdb
  </pre></div><p> Check the contents of the file hairpin.pdb. It should only have the atom records for residues 41 through 56. Next, let's regularize this file: </p>
<div class="fragment"><pre class="fragment">
  regularize hairpin.pdb
  </pre></div><p> There should be two output files, "min_etot.xml" and "min_rmsd.xml". We need the first, to get the native hydrogen bonds. </p>
<div class="fragment"><pre class="fragment">
  generate_contact_file -ct HBContact min_etot.xml -o hairpin.nhb
  </pre></div><p> This will generate an output file <code>hairpin.nhb</code> with the following contents: </p>
<div class="fragment"><pre class="fragment">
# Chain 0:   * GEWTYDDATKTFTVTE *
0  1  14
1  3  12
2  5  10
3  8  5
4  9  5
5  10  5
6  12  3
7  14  1
  </pre></div><p> The first line shows the sequence of the peptide segment. The residue indexes in the bond listing must be interpreted relative to this sequence, and they start from 0. So, the hydrogen bonds identified were 2 each between residue pairs 1(E)-14(T), 3(T)-12(T), 5(D)-10(T) and another between the NH dipole of 8(T) and the CO dipole of 5(D). PROFASI's <a class="el" href="classregularizer.html" title="A program to regularize PDB structures.">regularizer</a> uses a little bit of MC. So, you could run the <a class="el" href="classregularizer.html" title="A program to regularize PDB structures.">regularizer</a> a few times and choose the lowest energy regularized state found.</p>
<h2><a class="anchor" id="contactgen_opts">
Options supported by generate_contact_file</a></h2>
<ul>
<li><b>--output_file</b> or <b>-o</b> : Name of the output file </li>
<li><b>--contact_type</b> or <b>-ct</b> : Contact type. Possible values: Proximity, CaContact, HBContact, HPContact </li>
<li><b>--selection</b> or <b>-sl</b> : Select a certain range in a PDB file and work on it. </li>
<li><b>--aa_range</b> or <b>-r</b> : Exclude contacts outside a specified (C-style) residue range </li>
<li><b>--minimum_sequence_separation</b> or <b>-m</b> : Exclude pairs within a certain sequence separation </li>
<li><b>--cut_off</b> or <b>-c</b> : Distance cut-off for the definition of a contact </li>
<li><b>--threshold</b> or <b>-t</b> : Probability threshold to count a preserved contact </li>
<li><b>-log_level</b> or <b>-ll</b> : Log level of output messages</li>
</ul>
<p>Some of these options have been described above in the examples, and the others have fairly obvious meanings. But we would like to point out that the option <code>--aa_range</code> or <code>-r</code> is <b>not</b> the same as the option <code>--selection</code> . When you use <code>-sl</code>, you indicate that you want to work with the selected part of the protein in the simulation. When you use <code>-r</code> you indicate that you want a measurement of a limited part of all native contacts of the simulated system.</p>
<p>For example, let's consider the situation when we want to simulate the whole protein in 1GB1.pdb. We want to monitor only the hydrogen bonds corresponding to the helix (23 (ALA) to 36 (ASP)). The required contacts file will then be generated by </p>
<div class="fragment"><pre class="fragment">
    generate_contact_file -ct HBContact 1GB1_reg.pdb -o 1GB1_hel.nhb -r 22 35
    </pre></div><p>In the above, 1GB1_reg.pdb is obtained by first regularizing 1GB1.pdb and then converting the resulting min_etot.xml to a PDB file. The file 1GB1_hel.nhb will contain only a subset of all native contacts in 1GB1.pdb, but will number them relative to the sequence of whole chain. If you used the <code>-sl</code> option, the same contacts will be generated, but they will be numbered relative to the segment of the helix section alone. If that's what you want to simulate, fine. But in the present example, those indexes will correspond to the wrong residues of the chain.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The residue ranges in the <code>-r</code> option start from 0, while the <code>-sl</code> option makes a selection on the PDB file with numbering as in that file.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classprf_1_1ContactMap.html" title="Utility to help keep track of a set of contacts.">prf::ContactMap</a>, <a class="el" href="regul.html">Regularization: approximating a protein structure</a>, <a class="el" href="prf_convert.html">Converting between structure file formats</a>, <a class="el" href="pdb_slices.html">Extracting parts of a PDB file</a> </dd></dl>
</div>
<center>
<hr>
<small>
<strong>PROFASI: Protein Folding and Aggregation Simulator, Version 1.5 
</strong><br />
&copy; (2005-2009) <a href="http://www.thep.lu.se/~anders">Anders Irb&auml;ck</a>
and <a href="http://www.thep.lu.se/~sandipan">Sandipan Mohanty</a><br />
Documentation generated on 19 Jun 2014 using Doxygen version 1.6.1
</small>
</center>

</body>
</html> 
